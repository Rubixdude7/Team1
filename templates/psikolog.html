{% extends "base.html" %}
{% block title %}{{ psyc_info.full_name }}{% endblock %}
{% block content %}
<main id="psyc-page">
    <div class="box">
        <div style="float:right">
            <div aria-hidden="true" style="font-size:80%;">
                <img style="display:block;padding: 3px;width:128px;height:128px;border:1px solid #999;" src="{{ avatar_url }}" alt="[photograph of {{ psyc_info.full_name }}]" />
            </div>
            {% if can_edit %}
            <div>
                <a href="/psikolog/change_avatar"><i class="fa fa-image" aria-hidden="true"></i> Change Avatar</a>
            </div>
            {% endif %}
        </div>
        <h2>{{ psyc_info.full_name }}</h2>
        <!-- Hide stars for end of sprint
        <p><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="far fa-star" aria-hidden="true"></i> (1337)</p>
        -->
        <p class="psyc-qualifications">
            {{ psyc_info.qualifications }}
            {% if can_edit %}
            <a href="{{ url_for('edit_qualifications') }}"><span class="fa fa-edit" aria-hidden="true"></span> Edit Qualifications</a>
            {% endif %}
        </p>
        <div style="clear:both;"></div>
        <div class="calendar">
            <div class="cal-head">
                <div class="cal-month-name">
                    <div>
                        <i class="fa fa-calendar-alt" aria-hidden="true"></i>
                        <span id="cal-month-label" aria-live="polite" aria-relevant="text"></span>
                    </div>
                    <div>
                        <button aria-controls="cal-month-label" onclick="prevMonth()"><i class="fa fa-arrow-left" aria-hidden="true"></i><span class="sr-only">Previous Month</span></button>
                        <button aria-controls="cal-month-label" onclick="nextMonth()"><i class="fa fa-arrow-right" aria-hidden="true"></i><span class="sr-only">Next Month</span></button>
                    </div>
                </div><div class="cal-column-title" aria-hidden="true">
                    Minggu
                </div><div class="cal-column-title" aria-hidden="true">
                    Senin
                </div><div class="cal-column-title" aria-hidden="true">
                    Selasa
                </div><div class="cal-column-title" aria-hidden="true">
                    Rabu
                </div><div class="cal-column-title" aria-hidden="true">
                    Kamis
                </div><div class="cal-column-title" aria-hidden="true">
                    Jumat
                </div><div class="cal-column-title" aria-hidden="true">
                    Sabtu
                </div>
            </div>
            {% for week in range(6) %}
                <div class="cal-week">
                    {% for weekday in range(7) %}<div id="cal-day-{{ week*7 + weekday }}" class="cal-day">&nbsp;</div>{% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>
    <script type="text/javascript" src="/static/scripts/calendar.js"></script>
    <script type="text/javascript">
        function weekday_to_index(wkd_abbr) {
            if (wkd_abbr == "su")
                return 0;
            else if (wkd_abbr == "m")
                return 1;
            else if (wkd_abbr == "t")
                return 2;
            else if (wkd_abbr == "w")
                return 3;
            else if (wkd_abbr == "th")
                return 4;
            else if (wkd_abbr == "f")
                return 5;
            else if (wkd_abbr == "s")
                return 6;
        }
        
        var availabilities = new Array();
        {% for avail in availabilities %}
        availabilities[{{ loop.index - 1 }}] = new Availability(new Time("{{ avail['time_st'] }}"), new Time("{{ avail['time_end'] }}"), weekday_to_index("{{ avail['weekday'] }}"));
        {% endfor %}
        
        resetCalendar();
    </script>
    <div class="box">
        {% if can_edit %}
            <a href="/psikolog/write_blog_post"><i class="fa fa-plus" aria-hidden="true"></i> Write New Post</a>
        {% endif %}
        <div class="blog">
            {% for post in blog_posts %}
                <article>
                    <h3>{{ post['title'] }}</h3>
                    <p class="blog-date">posted {{ post['date_posted'] }}</p>
                    <p>{{ post['contents'] }}</p>
                </article>
            {% endfor %}
        </div>
    </div>
</main>
{% endblock %}
